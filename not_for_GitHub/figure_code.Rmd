---
title: "Figure Code"
author: "Zack Gold"
date: "10/21/2021"
output: html_document
---

```{r}
library(tidyverse)
library(tidybayes)
library(modelr)
library(rstanarm)
library(here)
```

```{R}

a <- tibble(temp_std=seq(11,18.5,0.5), Presence_absence = c(rep(0,5),rep(1,2),rep(0,2),rep(1,2),rep(1,5)), Species =rep("Mexican Lampfish",16))

model_holder <-
stan_glm(
Presence_absence ~ temp_std ,
#mod3
family = "binomial",
data = a,
prior = normal(0, 4),
prior_intercept = normal(0, 10),
#adapt_delta = 0.99,
chains = 2,
iter = 1000
)

a %>%
  data_grid(temp_std = seq_range(temp_std, n = 51)) %>%
  add_fitted_draws(model_holder) %>%
  ggplot( aes(x = (temp_std), y = Presence_absence)) +
  stat_lineribbon(aes(y = .value), color="darkred") +
  geom_point(data = a, aes(x = (temp_std), y = Presence_absence), color = "darkred") +
  scale_fill_brewer(palette = "Reds") +
  scale_color_brewer(palette = "Set2") +
  theme(axis.text.x = element_text(size=14), 
        panel.background = element_rect(fill='white', colour='white'),
          panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(), 
          axis.text.y=element_text(size=14, angle=0), 
          axis.title.x=element_text(size=18, angle=0,face="bold"), 
          axis.title.y=element_text(size=18, angle=90,face="bold"),
          strip.background = element_rect(fill='grey90'), 
          strip.text.x=element_text(size=15),
          legend.text=element_text(size=10),
          legend.title=element_text(size=15),
          axis.line=element_line(colour='black'))	+ xlab("SST ËšC") + ylab("Occurrence") + labs(fill='Confidence Interval') +
  facet_wrap(~Species) 


```